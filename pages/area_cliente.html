<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>√Årea do Cliente - DINA</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512" crossorigin="anonymous" />
</head>
<body class="bg-background text-text-primary flex h-screen">
    <!-- Sidebar -->
    <aside class="w-64 bg-surface border-r border-border flex flex-col">
        <div class="p-6 flex items-center justify-center border-b border-border">
            <svg class="h-10 w-10" viewBox="0 0 32 32" fill="none">
                <defs>
                    <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" style="stop-color:#8b5cf6"/>
                        <stop offset="100%" style="stop-color:#06b6d4"/>
                    </linearGradient>
                </defs>
                <path d="M16 2L30 9v14L16 30 2 23V9L16 2z" fill="url(#logoGradient)"/>
                <path d="M16 8L24 12v8l-8 4-8-4v-8l8-4z" fill="#0a0a0a"/>
                <circle cx="16" cy="16" r="3" fill="url(#logoGradient)"/>
            </svg>
            <span class="ml-2 font-heading text-xl font-bold text-gradient">DINA</span>
        </div>
        <nav class="flex-1 p-4">
            <ul class="space-y-4">
                <li><a href="#" class="flex items-center space-x-3 text-primary hover:underline"><i class="fa-solid fa-user"></i><span>Perfil</span></a></li>
                <li><a href="#" class="flex items-center space-x-3 hover:underline"><i class="fa-solid fa-cog"></i><span>Configura√ß√µes</span></a></li>
                <li><a href="#" class="flex items-center space-x-3 hover:underline"><i class="fa-solid fa-chart-line"></i><span>Dashboard</span></a></li>
            </ul>
        </nav>
        <div class="p-4 border-t border-border">
            <button id="logout" class="w-full btn-secondary"><i class="fa-solid fa-right-from-bracket mr-2"></i>Sair</button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8 overflow-y-auto">
        <h1 class="text-3xl font-bold mb-6">Bem-vindo(a) √† sua √°rea da DINA üöÄ</h1>
        <section id="user-info" class="mb-10 p-6 bg-surface rounded-lg border border-border shadow">
            <p class="text-text-secondary">Carregando seus dados...</p>
        </section>
        
        <!-- Cards de resumo -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
            <div class="p-6 bg-surface rounded-lg border border-border shadow">
                <h2 class="font-bold mb-2">Progresso</h2>
                <p class="text-text-secondary">Acompanhe seu avan√ßo na plataforma</p>
            </div>
            <div class="p-6 bg-surface rounded-lg border border-border shadow">
                <h2 class="font-bold mb-2">Metas</h2>
                <p class="text-text-secondary">Defina seus objetivos e acompanhe</p>
            </div>
            <div class="p-6 bg-surface rounded-lg border border-border shadow">
                <h2 class="font-bold mb-2">Notifica√ß√µes</h2>
                <p class="text-text-secondary">Fique por dentro das novidades</p>
            </div>
        </div>

        <!-- Sess√£o de a√ß√µes r√°pidas -->
        <div class="p-6 bg-surface rounded-lg border border-border shadow">
            <h2 class="text-xl font-bold mb-4">A√ß√µes r√°pidas</h2>
            <div class="flex flex-wrap gap-4">
                <button class="btn-primary"><i class="fa-solid fa-plus mr-2"></i>Nova Meta</button>
                <button class="btn-secondary"><i class="fa-solid fa-pen mr-2"></i>Editar Perfil</button>
            </div>
        </div>
    </main>

    <script>
        // ‚úÖ Captura token da URL se presente
        const urlParams = new URLSearchParams(window.location.search);
        const tokenFromURL = urlParams.get('token');

        if (tokenFromURL) {
            localStorage.setItem('token', tokenFromURL);
            const cleanUrl = window.location.origin + window.location.pathname;
            window.history.replaceState({}, document.title, cleanUrl);
        }

        const token = localStorage.getItem('token');
        if (!token) {
            window.location.href = 'login.html';
        }

        // üîé Busca dados do usu√°rio
        fetch('https://dina-backend-5uop.onrender.com/me', {
            headers: {
                'Authorization': 'Bearer ' + token
            }
        })
        .then(response => {
            if (!response.ok) throw new Error('Token inv√°lido');
            return response.json();
        })
        .then(user => {
            const userInfo = document.getElementById('user-info');
            userInfo.innerHTML = `
                <h2 class="text-xl font-bold mb-4">Seus Dados</h2>
                <p><strong>Nome:</strong> ${user.nome}</p>
                <p><strong>Email:</strong> ${user.email}</p>
                <p><strong>Experi√™ncia:</strong> ${user.experiencia || '‚Äî'}</p>
                <p><strong>Objetivo:</strong> ${user.objetivo || '‚Äî'}</p>
            `;
        })
        .catch(() => {
            localStorage.removeItem('token');
            window.location.href = 'login.html';
        });

        // üîí Logout
        document.getElementById('logout').addEventListener('click', () => {
            localStorage.removeItem('token');
            window.location.href = 'login.html';
        });
    </script>
</body>
</html>
